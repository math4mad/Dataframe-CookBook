{
  "hash": "817e43ca5f5f879942ff89d05fd5f43f",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Video Game Data Visualization-Tidier.jl \"\nauthor: \"math4mads\"\ndate: \"2023-12-14\"\ncategories: [dataframe,visualization,julia]\nimage: \"image.png\"\n---\n\n:::{.callout-note title=\"简介\"}\nref :[Video games sales analysis and visualization](https://www.kaggle.com/code/snanilim/video-games-sales-analysis-and-visualization/notebook#notebook-container)\n \n:::\n\n## 1. load package\n\n::: {#bd9b3f0e .cell execution_count=1}\n``` {.julia .cell-code}\ninclude(\"../utils.jl\")   # import load_csv method\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```\n(marker = :circle, markersize = 12, color = (:green, 0.2), strokewidth = 1, strokecolor = :black)\n```\n:::\n:::\n\n\n## 2. load data\n\n::: {#7cfc81a9 .cell execution_count=2}\n``` {.julia .cell-code}\ndf =load_csv(\"vgsales\",false)\n@pipe names(df)|>lowercase.(_)|>rename!(df,_)\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div><div style = \"float: left;\"><span>16598×11 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">16573 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">rank</th><th style = \"text-align: left;\">name</th><th style = \"text-align: left;\">platform</th><th style = \"text-align: left;\">year</th><th style = \"text-align: left;\">genre</th><th style = \"text-align: left;\">publisher</th><th style = \"text-align: left;\">na_sales</th><th style = \"text-align: left;\">eu_sales</th><th style = \"text-align: left;\">jp_sales</th><th style = \"text-align: left;\">other_sales</th><th style = \"text-align: left;\">global_sales</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"Int64\" style = \"text-align: left;\">Int64</th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"String7\" style = \"text-align: left;\">String7</th><th title = \"String7\" style = \"text-align: left;\">String7</th><th title = \"String15\" style = \"text-align: left;\">String15</th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: right;\">1</td><td style = \"text-align: left;\">Wii Sports</td><td style = \"text-align: left;\">Wii</td><td style = \"text-align: left;\">2006</td><td style = \"text-align: left;\">Sports</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">41.49</td><td style = \"text-align: right;\">29.02</td><td style = \"text-align: right;\">3.77</td><td style = \"text-align: right;\">8.46</td><td style = \"text-align: right;\">82.74</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: right;\">2</td><td style = \"text-align: left;\">Super Mario Bros.</td><td style = \"text-align: left;\">NES</td><td style = \"text-align: left;\">1985</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">29.08</td><td style = \"text-align: right;\">3.58</td><td style = \"text-align: right;\">6.81</td><td style = \"text-align: right;\">0.77</td><td style = \"text-align: right;\">40.24</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: right;\">3</td><td style = \"text-align: left;\">Mario Kart Wii</td><td style = \"text-align: left;\">Wii</td><td style = \"text-align: left;\">2008</td><td style = \"text-align: left;\">Racing</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">15.85</td><td style = \"text-align: right;\">12.88</td><td style = \"text-align: right;\">3.79</td><td style = \"text-align: right;\">3.31</td><td style = \"text-align: right;\">35.82</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: right;\">4</td><td style = \"text-align: left;\">Wii Sports Resort</td><td style = \"text-align: left;\">Wii</td><td style = \"text-align: left;\">2009</td><td style = \"text-align: left;\">Sports</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">15.75</td><td style = \"text-align: right;\">11.01</td><td style = \"text-align: right;\">3.28</td><td style = \"text-align: right;\">2.96</td><td style = \"text-align: right;\">33.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: right;\">5</td><td style = \"text-align: left;\">Pokemon Red/Pokemon Blue</td><td style = \"text-align: left;\">GB</td><td style = \"text-align: left;\">1996</td><td style = \"text-align: left;\">Role-Playing</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">11.27</td><td style = \"text-align: right;\">8.89</td><td style = \"text-align: right;\">10.22</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">31.37</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: right;\">6</td><td style = \"text-align: left;\">Tetris</td><td style = \"text-align: left;\">GB</td><td style = \"text-align: left;\">1989</td><td style = \"text-align: left;\">Puzzle</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">23.2</td><td style = \"text-align: right;\">2.26</td><td style = \"text-align: right;\">4.22</td><td style = \"text-align: right;\">0.58</td><td style = \"text-align: right;\">30.26</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: right;\">7</td><td style = \"text-align: left;\">New Super Mario Bros.</td><td style = \"text-align: left;\">DS</td><td style = \"text-align: left;\">2006</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">11.38</td><td style = \"text-align: right;\">9.23</td><td style = \"text-align: right;\">6.5</td><td style = \"text-align: right;\">2.9</td><td style = \"text-align: right;\">30.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: right;\">8</td><td style = \"text-align: left;\">Wii Play</td><td style = \"text-align: left;\">Wii</td><td style = \"text-align: left;\">2006</td><td style = \"text-align: left;\">Misc</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">14.03</td><td style = \"text-align: right;\">9.2</td><td style = \"text-align: right;\">2.93</td><td style = \"text-align: right;\">2.85</td><td style = \"text-align: right;\">29.02</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: right;\">9</td><td style = \"text-align: left;\">New Super Mario Bros. Wii</td><td style = \"text-align: left;\">Wii</td><td style = \"text-align: left;\">2009</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">14.59</td><td style = \"text-align: right;\">7.06</td><td style = \"text-align: right;\">4.7</td><td style = \"text-align: right;\">2.26</td><td style = \"text-align: right;\">28.62</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: right;\">10</td><td style = \"text-align: left;\">Duck Hunt</td><td style = \"text-align: left;\">NES</td><td style = \"text-align: left;\">1984</td><td style = \"text-align: left;\">Shooter</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">26.93</td><td style = \"text-align: right;\">0.63</td><td style = \"text-align: right;\">0.28</td><td style = \"text-align: right;\">0.47</td><td style = \"text-align: right;\">28.31</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: right;\">11</td><td style = \"text-align: left;\">Nintendogs</td><td style = \"text-align: left;\">DS</td><td style = \"text-align: left;\">2005</td><td style = \"text-align: left;\">Simulation</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">9.07</td><td style = \"text-align: right;\">11.0</td><td style = \"text-align: right;\">1.93</td><td style = \"text-align: right;\">2.75</td><td style = \"text-align: right;\">24.76</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: right;\">12</td><td style = \"text-align: left;\">Mario Kart DS</td><td style = \"text-align: left;\">DS</td><td style = \"text-align: left;\">2005</td><td style = \"text-align: left;\">Racing</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">9.81</td><td style = \"text-align: right;\">7.57</td><td style = \"text-align: right;\">4.13</td><td style = \"text-align: right;\">1.92</td><td style = \"text-align: right;\">23.42</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: right;\">13</td><td style = \"text-align: left;\">Pokemon Gold/Pokemon Silver</td><td style = \"text-align: left;\">GB</td><td style = \"text-align: left;\">1999</td><td style = \"text-align: left;\">Role-Playing</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">9.0</td><td style = \"text-align: right;\">6.18</td><td style = \"text-align: right;\">7.2</td><td style = \"text-align: right;\">0.71</td><td style = \"text-align: right;\">23.1</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16587</td><td style = \"text-align: right;\">16589</td><td style = \"text-align: left;\">Secret Files 2: Puritas Cordis</td><td style = \"text-align: left;\">DS</td><td style = \"text-align: left;\">2009</td><td style = \"text-align: left;\">Adventure</td><td style = \"text-align: left;\">Deep Silver</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16588</td><td style = \"text-align: right;\">16590</td><td style = \"text-align: left;\">Mezase!! Tsuri Master DS</td><td style = \"text-align: left;\">DS</td><td style = \"text-align: left;\">2009</td><td style = \"text-align: left;\">Sports</td><td style = \"text-align: left;\">Hudson Soft</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16589</td><td style = \"text-align: right;\">16591</td><td style = \"text-align: left;\">Mega Brain Boost</td><td style = \"text-align: left;\">DS</td><td style = \"text-align: left;\">2008</td><td style = \"text-align: left;\">Puzzle</td><td style = \"text-align: left;\">Majesco Entertainment</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16590</td><td style = \"text-align: right;\">16592</td><td style = \"text-align: left;\">Chou Ezaru wa Akai Hana: Koi wa Tsuki ni Shirube Kareru</td><td style = \"text-align: left;\">PSV</td><td style = \"text-align: left;\">2016</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: left;\">dramatic create</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16591</td><td style = \"text-align: right;\">16593</td><td style = \"text-align: left;\">Eiyuu Densetsu: Sora no Kiseki Material Collection Portable</td><td style = \"text-align: left;\">PSP</td><td style = \"text-align: left;\">2007</td><td style = \"text-align: left;\">Role-Playing</td><td style = \"text-align: left;\">Falcom Corporation</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16592</td><td style = \"text-align: right;\">16594</td><td style = \"text-align: left;\">Myst IV: Revelation</td><td style = \"text-align: left;\">PC</td><td style = \"text-align: left;\">2004</td><td style = \"text-align: left;\">Adventure</td><td style = \"text-align: left;\">Ubisoft</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16593</td><td style = \"text-align: right;\">16595</td><td style = \"text-align: left;\">Plushees</td><td style = \"text-align: left;\">DS</td><td style = \"text-align: left;\">2008</td><td style = \"text-align: left;\">Simulation</td><td style = \"text-align: left;\">Destineer</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16594</td><td style = \"text-align: right;\">16596</td><td style = \"text-align: left;\">Woody Woodpecker in Crazy Castle 5</td><td style = \"text-align: left;\">GBA</td><td style = \"text-align: left;\">2002</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: left;\">Kemco</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16595</td><td style = \"text-align: right;\">16597</td><td style = \"text-align: left;\">Men in Black II: Alien Escape</td><td style = \"text-align: left;\">GC</td><td style = \"text-align: left;\">2003</td><td style = \"text-align: left;\">Shooter</td><td style = \"text-align: left;\">Infogrames</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16596</td><td style = \"text-align: right;\">16598</td><td style = \"text-align: left;\">SCORE International Baja 1000: The Official Game</td><td style = \"text-align: left;\">PS2</td><td style = \"text-align: left;\">2008</td><td style = \"text-align: left;\">Racing</td><td style = \"text-align: left;\">Activision</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16597</td><td style = \"text-align: right;\">16599</td><td style = \"text-align: left;\">Know How 2</td><td style = \"text-align: left;\">DS</td><td style = \"text-align: left;\">2010</td><td style = \"text-align: left;\">Puzzle</td><td style = \"text-align: left;\">7G//AMES</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16598</td><td style = \"text-align: right;\">16600</td><td style = \"text-align: left;\">Spirits &amp; Spells</td><td style = \"text-align: left;\">GBA</td><td style = \"text-align: left;\">2003</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: left;\">Wanadoo</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 3.  data visualization\n### 3.1 What genre games have been made the most?\n\n::: {#0e9aad87 .cell execution_count=3}\n``` {.julia .cell-code}\ndf1=@chain df begin\n    @group_by(genre)\n    @summarize(counts =nrow())\n    @arrange(desc(counts))\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div><div style = \"float: left;\"><span>12×2 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">genre</th><th style = \"text-align: left;\">counts</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String15\" style = \"text-align: left;\">String15</th><th title = \"Int64\" style = \"text-align: left;\">Int64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">3316</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">Sports</td><td style = \"text-align: right;\">2346</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">Misc</td><td style = \"text-align: right;\">1739</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">Role-Playing</td><td style = \"text-align: right;\">1488</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">Shooter</td><td style = \"text-align: right;\">1310</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">Adventure</td><td style = \"text-align: right;\">1286</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">Racing</td><td style = \"text-align: right;\">1249</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: right;\">886</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">Simulation</td><td style = \"text-align: right;\">867</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">Fighting</td><td style = \"text-align: right;\">848</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">Strategy</td><td style = \"text-align: right;\">681</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">Puzzle</td><td style = \"text-align: right;\">582</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {#2b23b09f .cell execution_count=4}\n``` {.julia .cell-code}\nfunction plot_df3_1(df::AbstractDataFrame)\n    rows,_=size(df)\n    featrues=names(df)\n    fig=Figure(resolution=(500,600))\n    ax=Axis(fig[1,1],title=\"counts of game by genre\")\n    ax.yticks=(1:rows,df.genre)\n    #ax.xticklabelrotation = pi/2\n    ax.xlabel=\"counts\"\n    ax.ylabel=\"genre\"\n    GLMakie.barplot!(ax,1:rows,df.counts;color = df.counts, strokecolor = :black, strokewidth = 1,direction=:x)\n    GLMakie.hidedecorations!(ax,label = false, ticklabels = false, ticks = false)\n    fig\nend\nplot_df3_1(df1)\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n![](tidier-method_files/figure-html/cell-5-output-1.png){}\n:::\n:::\n\n\n### 3.2 Which year had the most game release?\n\n::: {#38925515 .cell execution_count=5}\n``` {.julia .cell-code}\ndf2=@chain df begin\n    @group_by(year)\n    @summarize(counts =nrow())\n    @arrange(desc(counts))\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div><div style = \"float: left;\"><span>40×2 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">15 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">year</th><th style = \"text-align: left;\">counts</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String7\" style = \"text-align: left;\">String7</th><th title = \"Int64\" style = \"text-align: left;\">Int64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">2009</td><td style = \"text-align: right;\">1431</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">2008</td><td style = \"text-align: right;\">1428</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">2010</td><td style = \"text-align: right;\">1259</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">2007</td><td style = \"text-align: right;\">1202</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">2011</td><td style = \"text-align: right;\">1139</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">2006</td><td style = \"text-align: right;\">1008</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">2005</td><td style = \"text-align: right;\">941</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">2002</td><td style = \"text-align: right;\">829</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">2003</td><td style = \"text-align: right;\">775</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">2004</td><td style = \"text-align: right;\">763</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">2012</td><td style = \"text-align: right;\">657</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">2015</td><td style = \"text-align: right;\">614</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">2014</td><td style = \"text-align: right;\">582</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">29</td><td style = \"text-align: left;\">1982</td><td style = \"text-align: right;\">36</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">30</td><td style = \"text-align: left;\">1986</td><td style = \"text-align: right;\">21</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">31</td><td style = \"text-align: left;\">1983</td><td style = \"text-align: right;\">17</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">32</td><td style = \"text-align: left;\">1989</td><td style = \"text-align: right;\">17</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">33</td><td style = \"text-align: left;\">1987</td><td style = \"text-align: right;\">16</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">34</td><td style = \"text-align: left;\">1990</td><td style = \"text-align: right;\">16</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">35</td><td style = \"text-align: left;\">1988</td><td style = \"text-align: right;\">15</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">36</td><td style = \"text-align: left;\">1984</td><td style = \"text-align: right;\">14</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">37</td><td style = \"text-align: left;\">1985</td><td style = \"text-align: right;\">14</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">38</td><td style = \"text-align: left;\">1980</td><td style = \"text-align: right;\">9</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">39</td><td style = \"text-align: left;\">2017</td><td style = \"text-align: right;\">3</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">40</td><td style = \"text-align: left;\">2020</td><td style = \"text-align: right;\">1</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {#a91ca184 .cell execution_count=6}\n``` {.julia .cell-code}\nfunction plot_df3_2(df::AbstractDataFrame,cat::String=\"year\")\n    @assert names(df)[2]==\"counts\"\n    rows=nrow(df)\n    fig=Figure(resolution=(500,800))\n    ax=Axis(fig[1,1],title=\"count game by year\")\n    ax.yticks=(1:rows,df[:,cat])\n    #ax.xticklabelrotation = pi/2\n    ax.xlabel=\"counts\"\n    ax.ylabel=\"$cat\"\n    GLMakie.barplot!(ax,1:rows,df.counts;color = df.counts, strokecolor = :black, strokewidth = 1,direction=:x)\n    GLMakie.hidedecorations!(ax,label = false, ticklabels = false, ticks = false)\n    fig\nend\n\nplot_df3_2(df2)\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n![](tidier-method_files/figure-html/cell-7-output-1.png){}\n:::\n:::\n\n\n### 3.3  Top 5 years games release by genre\n\n::: {#5fc9f705 .cell execution_count=7}\n``` {.julia .cell-code}\n\"\"\"\nloading ....\n\"\"\"\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\n\"loading ....\\n\"\n```\n:::\n:::\n\n\n###  3.4 Which year had the highest sales worldwide?\n\n::: {#8e0ec3d7 .cell execution_count=8}\n``` {.julia .cell-code}\ndf4=@chain df begin\n    @group_by(year)\n    @summarize(sales =sum(global_sales))\n    @arrange(desc(sales))\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<div><div style = \"float: left;\"><span>40×2 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">15 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">year</th><th style = \"text-align: left;\">sales</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String7\" style = \"text-align: left;\">String7</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">2008</td><td style = \"text-align: right;\">678.9</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">2009</td><td style = \"text-align: right;\">667.3</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">2007</td><td style = \"text-align: right;\">611.13</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">2010</td><td style = \"text-align: right;\">600.45</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">2006</td><td style = \"text-align: right;\">521.04</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">2011</td><td style = \"text-align: right;\">515.99</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">2005</td><td style = \"text-align: right;\">459.94</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">2004</td><td style = \"text-align: right;\">419.31</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">2002</td><td style = \"text-align: right;\">395.52</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">2013</td><td style = \"text-align: right;\">368.11</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">2012</td><td style = \"text-align: right;\">363.54</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">2003</td><td style = \"text-align: right;\">357.85</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">2014</td><td style = \"text-align: right;\">337.05</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">29</td><td style = \"text-align: left;\">1990</td><td style = \"text-align: right;\">49.39</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">30</td><td style = \"text-align: left;\">1988</td><td style = \"text-align: right;\">47.22</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">31</td><td style = \"text-align: left;\">1993</td><td style = \"text-align: right;\">45.98</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">32</td><td style = \"text-align: left;\">1986</td><td style = \"text-align: right;\">37.07</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">33</td><td style = \"text-align: left;\">1981</td><td style = \"text-align: right;\">35.77</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">34</td><td style = \"text-align: left;\">1991</td><td style = \"text-align: right;\">32.23</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">35</td><td style = \"text-align: left;\">1982</td><td style = \"text-align: right;\">28.86</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">36</td><td style = \"text-align: left;\">1987</td><td style = \"text-align: right;\">21.74</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">37</td><td style = \"text-align: left;\">1983</td><td style = \"text-align: right;\">16.79</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">38</td><td style = \"text-align: left;\">1980</td><td style = \"text-align: right;\">11.38</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">39</td><td style = \"text-align: left;\">2020</td><td style = \"text-align: right;\">0.29</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">40</td><td style = \"text-align: left;\">2017</td><td style = \"text-align: right;\">0.05</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {#b875771f .cell execution_count=9}\n``` {.julia .cell-code}\nfunction plot_df3_4(df::AbstractDataFrame)\n    rows=nrow(df)\n    fig=Figure(resolution=(500,700))\n    ax=Axis(fig[1,1],title=\"video game global sales\")\n    ax.yticks=(1:rows,df[:,\"year\"])\n    #ax.xticklabelrotation = pi/2\n    ax.xlabel=\"sales\"\n    ax.ylabel=\"year\"\n    GLMakie.barplot!(ax,1:rows,df.sales;color = df.sales, strokecolor = :black, strokewidth = 1,direction=:x)\n    GLMakie.hidedecorations!(ax,label = false, ticklabels = false, ticks = false)\n    fig\nend\nplot_df3_4(df4)\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n![](tidier-method_files/figure-html/cell-10-output-1.png){}\n:::\n:::\n\n\n### 3.5 Which genre game has been released the most in a single year?\n\n::: {#bad308a8 .cell execution_count=10}\n``` {.julia .cell-code}\ndf5=@chain df begin\n    @group_by(year,genre)\n    @summarize(counts =nrow())\n    @arrange(desc(counts)) # 在每个组中按数量降序排列\n    @slice(1)              # 每组最多发布游戏的一行\n    @ungroup\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```{=html}\n<div><div style = \"float: left;\"><span>40×3 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">15 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">year</th><th style = \"text-align: left;\">genre</th><th style = \"text-align: left;\">counts</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String7\" style = \"text-align: left;\">String7</th><th title = \"String15\" style = \"text-align: left;\">String15</th><th title = \"Int64\" style = \"text-align: left;\">Int64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">1980</td><td style = \"text-align: left;\">Misc</td><td style = \"text-align: right;\">4</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">1981</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">25</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">1982</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">18</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">1983</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">7</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">1984</td><td style = \"text-align: left;\">Puzzle</td><td style = \"text-align: right;\">3</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">1985</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: right;\">4</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">1986</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">1987</td><td style = \"text-align: left;\">Sports</td><td style = \"text-align: right;\">4</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">1988</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: right;\">4</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">1989</td><td style = \"text-align: left;\">Puzzle</td><td style = \"text-align: right;\">5</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">1990</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">3</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">1991</td><td style = \"text-align: left;\">Sports</td><td style = \"text-align: right;\">7</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">1992</td><td style = \"text-align: left;\">Fighting</td><td style = \"text-align: right;\">7</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">29</td><td style = \"text-align: left;\">2008</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">221</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">30</td><td style = \"text-align: left;\">2009</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">272</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">31</td><td style = \"text-align: left;\">2010</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">226</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">32</td><td style = \"text-align: left;\">2011</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">239</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">33</td><td style = \"text-align: left;\">2012</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">266</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">34</td><td style = \"text-align: left;\">2013</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">148</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">35</td><td style = \"text-align: left;\">2014</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">186</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">36</td><td style = \"text-align: left;\">2015</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">255</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">37</td><td style = \"text-align: left;\">2016</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">119</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">38</td><td style = \"text-align: left;\">2017</td><td style = \"text-align: left;\">Role-Playing</td><td style = \"text-align: right;\">2</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">39</td><td style = \"text-align: left;\">2020</td><td style = \"text-align: left;\">Simulation</td><td style = \"text-align: right;\">1</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">40</td><td style = \"text-align: left;\">N/A</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">63</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {#8f9b4175 .cell execution_count=11}\n``` {.julia .cell-code}\n    function plot_df3_5(df::AbstractDataFrame)\n    #@assert names(df)[2]==\"counts\"\n    rows=nrow(df)\n    fig=Figure(resolution=(1000,900))\n    ax=Axis(fig[1,1],title=\"video game most release in single year\")\n    ax.yticks=(1:rows,df[:,\"year\"])\n    #ax.xticklabelrotation = pi/2\n    ax.xlabel=\"release\"\n    ax.ylabel=\"year\"\n    GLMakie.barplot!(ax,1:rows,df.counts;color = df.counts, strokecolor = :black, strokewidth = 1,direction=:x\n    \n    )\n    for (idx, row) in enumerate(eachrow(df))\n        counts,year,genre=row.counts,row.year,row.genre\n        GLMakie.text!(ax,counts+2,idx; text=\"$genre-$year\",align = (:left, :center),fontsize=8)\n    end\n    \n    GLMakie.hidedecorations!(ax,label = false, ticklabels = false, ticks = false)\n    fig\nend    \n plot_df3_5(df5)\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n![](tidier-method_files/figure-html/cell-12-output-1.png){}\n:::\n:::\n\n\n#### 3.6 Which genre game has sold the most in a single year?\n\n::: {#d0ec4332 .cell execution_count=12}\n``` {.julia .cell-code}\ndf6=@chain df begin\n    @group_by(year,genre)\n    @summarize(sales =sum(global_sales))\n    @arrange(desc(sales)) # 在每个组中按全球销售额降序排列\n    @slice(1)              # 每组销量最多的\n    @ungroup\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```{=html}\n<div><div style = \"float: left;\"><span>40×3 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">15 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">year</th><th style = \"text-align: left;\">genre</th><th style = \"text-align: left;\">sales</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String7\" style = \"text-align: left;\">String7</th><th title = \"String15\" style = \"text-align: left;\">String15</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">1980</td><td style = \"text-align: left;\">Shooter</td><td style = \"text-align: right;\">7.07</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">1981</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">14.84</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">1982</td><td style = \"text-align: left;\">Puzzle</td><td style = \"text-align: right;\">10.03</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">1983</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: right;\">6.93</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">1984</td><td style = \"text-align: left;\">Shooter</td><td style = \"text-align: right;\">31.1</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">1985</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: right;\">43.17</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">1986</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">13.74</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">1987</td><td style = \"text-align: left;\">Fighting</td><td style = \"text-align: right;\">5.42</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">1988</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: right;\">27.73</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">1989</td><td style = \"text-align: left;\">Puzzle</td><td style = \"text-align: right;\">37.75</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">1990</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: right;\">22.97</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">1991</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: right;\">7.64</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">1992</td><td style = \"text-align: left;\">Fighting</td><td style = \"text-align: right;\">15.25</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">29</td><td style = \"text-align: left;\">2008</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">136.39</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">30</td><td style = \"text-align: left;\">2009</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">139.36</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">31</td><td style = \"text-align: left;\">2010</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">117.64</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">32</td><td style = \"text-align: left;\">2011</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">118.96</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">33</td><td style = \"text-align: left;\">2012</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">122.04</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">34</td><td style = \"text-align: left;\">2013</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">125.22</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">35</td><td style = \"text-align: left;\">2014</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">99.02</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">36</td><td style = \"text-align: left;\">2015</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">70.7</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">37</td><td style = \"text-align: left;\">2016</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">19.91</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">38</td><td style = \"text-align: left;\">2017</td><td style = \"text-align: left;\">Role-Playing</td><td style = \"text-align: right;\">0.04</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">39</td><td style = \"text-align: left;\">2020</td><td style = \"text-align: left;\">Simulation</td><td style = \"text-align: right;\">0.29</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">40</td><td style = \"text-align: left;\">N/A</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">28.3</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n### 3.7 Which genre game have the highest sale price globally?\n\n::: {#313d171b .cell execution_count=13}\n``` {.julia .cell-code}\ndf7=@chain df begin\n    @group_by(genre)\n    @summarize(sales =sum(global_sales))\n    @arrange(desc(sales)) # 在每个组中按全球销售额降序排列\n             # 每组销量最对的\n    @ungroup\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```{=html}\n<div><div style = \"float: left;\"><span>12×2 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">genre</th><th style = \"text-align: left;\">sales</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String15\" style = \"text-align: left;\">String15</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">1751.18</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">Sports</td><td style = \"text-align: right;\">1330.93</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">Shooter</td><td style = \"text-align: right;\">1037.37</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">Role-Playing</td><td style = \"text-align: right;\">927.37</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: right;\">831.37</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">Misc</td><td style = \"text-align: right;\">809.96</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">Racing</td><td style = \"text-align: right;\">732.04</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">Fighting</td><td style = \"text-align: right;\">448.91</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">Simulation</td><td style = \"text-align: right;\">392.2</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">Puzzle</td><td style = \"text-align: right;\">244.95</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">Adventure</td><td style = \"text-align: right;\">239.04</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">Strategy</td><td style = \"text-align: right;\">175.12</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {#d54dd812 .cell execution_count=14}\n``` {.julia .cell-code}\nfunction plot_df3_7(df::AbstractDataFrame)\n    #@assert names(df)[2]==\"counts\"\n    rows=nrow(df)\n    fig=Figure(resolution=(800,500))\n    ax=Axis(fig[1,1],title=\"video game sales champion by genre\")\n    ax.yticks=(1:rows,df[:,\"genre\"])\n    #ax.xticklabelrotation = pi/2\n    ax.xlabel=\"sales\"\n    ax.ylabel=\"genre\"\n    GLMakie.barplot!(ax,1:rows,df.sales;color = df.sales, strokecolor = :black, strokewidth = 1,direction=:x,\n    bar_labels=:y )\n    GLMakie.hidedecorations!(ax,label = false, ticklabels = false, ticks = false)\n    fig\nend\nplot_df3_7(df7)\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n![](tidier-method_files/figure-html/cell-15-output-1.png){}\n:::\n:::\n\n\n###  3.8 Which platfrom have the highest sale price globally?\n\n::: {#31a3e98d .cell execution_count=15}\n``` {.julia .cell-code}\ndf8=@chain df begin\n    @group_by(platform)\n    @summarize(sales =sum(global_sales))\n    @arrange(desc(sales)) # 在每个组中按全球销售额降序排列\n    @ungroup\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```{=html}\n<div><div style = \"float: left;\"><span>31×2 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">6 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">platform</th><th style = \"text-align: left;\">sales</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String7\" style = \"text-align: left;\">String7</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">PS2</td><td style = \"text-align: right;\">1255.64</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">X360</td><td style = \"text-align: right;\">979.96</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">PS3</td><td style = \"text-align: right;\">957.84</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">Wii</td><td style = \"text-align: right;\">926.71</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">DS</td><td style = \"text-align: right;\">822.49</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">PS</td><td style = \"text-align: right;\">730.66</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">GBA</td><td style = \"text-align: right;\">318.5</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">PSP</td><td style = \"text-align: right;\">296.28</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">PS4</td><td style = \"text-align: right;\">278.1</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">PC</td><td style = \"text-align: right;\">258.82</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">XB</td><td style = \"text-align: right;\">258.26</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">GB</td><td style = \"text-align: right;\">255.45</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">NES</td><td style = \"text-align: right;\">251.07</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">20</td><td style = \"text-align: left;\">WiiU</td><td style = \"text-align: right;\">81.86</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">21</td><td style = \"text-align: left;\">PSV</td><td style = \"text-align: right;\">61.93</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">22</td><td style = \"text-align: left;\">SAT</td><td style = \"text-align: right;\">33.59</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">23</td><td style = \"text-align: left;\">GEN</td><td style = \"text-align: right;\">28.36</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">24</td><td style = \"text-align: left;\">DC</td><td style = \"text-align: right;\">15.97</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">25</td><td style = \"text-align: left;\">SCD</td><td style = \"text-align: right;\">1.87</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">26</td><td style = \"text-align: left;\">NG</td><td style = \"text-align: right;\">1.44</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">27</td><td style = \"text-align: left;\">WS</td><td style = \"text-align: right;\">1.42</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">28</td><td style = \"text-align: left;\">TG16</td><td style = \"text-align: right;\">0.16</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">29</td><td style = \"text-align: left;\">3DO</td><td style = \"text-align: right;\">0.1</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">30</td><td style = \"text-align: left;\">GG</td><td style = \"text-align: right;\">0.04</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">31</td><td style = \"text-align: left;\">PCFX</td><td style = \"text-align: right;\">0.03</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {#54fbd50e .cell execution_count=16}\n``` {.julia .cell-code}\nfunction plot_df3_8(df::AbstractDataFrame)\n    #@assert names(df)[2]==\"counts\"\n    rows=nrow(df)\n    fig=Figure(resolution=(600,800))\n    ax=Axis(fig[1,1],title=\"video game sales by Platform\")\n    ax.yticks=(1:rows,df[:,\"platform\"])\n    #ax.xticklabelrotation = pi/2\n    ax.xlabel=\"sales\"\n    ax.ylabel=\"platform\"\n    GLMakie.barplot!(ax,1:rows,df.sales;color = df.sales, strokecolor = :black, strokewidth = 1,direction=:x,\n    bar_labels=:y )\n    GLMakie.hidedecorations!(ax,label = false, ticklabels = false, ticks = false)\n    fig\nend\n\nplot_df3_8(df8)\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n![](tidier-method_files/figure-html/cell-17-output-1.png){}\n:::\n:::\n\n\n### 3.9 Which individual game have the highest sale price globally?\n\n::: {#dcd9a798 .cell execution_count=17}\n``` {.julia .cell-code}\ndf9=@chain df begin\n    @select(name,year,global_sales)\n    @arrange(desc(global_sales)) # 在每个组中按全球销售额降序排列\n    @slice(1:20)\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```{=html}\n<div><div style = \"float: left;\"><span>20×3 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">name</th><th style = \"text-align: left;\">year</th><th style = \"text-align: left;\">global_sales</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"String7\" style = \"text-align: left;\">String7</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">Wii Sports</td><td style = \"text-align: left;\">2006</td><td style = \"text-align: right;\">82.74</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">Super Mario Bros.</td><td style = \"text-align: left;\">1985</td><td style = \"text-align: right;\">40.24</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">Mario Kart Wii</td><td style = \"text-align: left;\">2008</td><td style = \"text-align: right;\">35.82</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">Wii Sports Resort</td><td style = \"text-align: left;\">2009</td><td style = \"text-align: right;\">33.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">Pokemon Red/Pokemon Blue</td><td style = \"text-align: left;\">1996</td><td style = \"text-align: right;\">31.37</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">Tetris</td><td style = \"text-align: left;\">1989</td><td style = \"text-align: right;\">30.26</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">New Super Mario Bros.</td><td style = \"text-align: left;\">2006</td><td style = \"text-align: right;\">30.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">Wii Play</td><td style = \"text-align: left;\">2006</td><td style = \"text-align: right;\">29.02</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">New Super Mario Bros. Wii</td><td style = \"text-align: left;\">2009</td><td style = \"text-align: right;\">28.62</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">Duck Hunt</td><td style = \"text-align: left;\">1984</td><td style = \"text-align: right;\">28.31</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">Nintendogs</td><td style = \"text-align: left;\">2005</td><td style = \"text-align: right;\">24.76</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">Mario Kart DS</td><td style = \"text-align: left;\">2005</td><td style = \"text-align: right;\">23.42</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">Pokemon Gold/Pokemon Silver</td><td style = \"text-align: left;\">1999</td><td style = \"text-align: right;\">23.1</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14</td><td style = \"text-align: left;\">Wii Fit</td><td style = \"text-align: left;\">2007</td><td style = \"text-align: right;\">22.72</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">15</td><td style = \"text-align: left;\">Wii Fit Plus</td><td style = \"text-align: left;\">2009</td><td style = \"text-align: right;\">22.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16</td><td style = \"text-align: left;\">Kinect Adventures!</td><td style = \"text-align: left;\">2010</td><td style = \"text-align: right;\">21.82</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">17</td><td style = \"text-align: left;\">Grand Theft Auto V</td><td style = \"text-align: left;\">2013</td><td style = \"text-align: right;\">21.4</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">18</td><td style = \"text-align: left;\">Grand Theft Auto: San Andreas</td><td style = \"text-align: left;\">2004</td><td style = \"text-align: right;\">20.81</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">19</td><td style = \"text-align: left;\">Super Mario World</td><td style = \"text-align: left;\">1990</td><td style = \"text-align: right;\">20.61</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">20</td><td style = \"text-align: left;\">Brain Age: Train Your Brain in Minutes a Day</td><td style = \"text-align: left;\">2005</td><td style = \"text-align: right;\">20.22</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {#723ee2ad .cell execution_count=18}\n``` {.julia .cell-code}\nfunction plot_top20_game(df::AbstractDataFrame)\n    #@assert names(df)[2]==\"counts\"\n    rows=nrow(df)\n    fig=Figure(resolution=(800,800))\n    ax=Axis(fig[1,1],title=\"global sales top 20\")\n    ax.yticks=(1:rows,df[:,\"name\"])\n    #ax.xticklabelrotation = pi/2\n    ax.xlabel=\"sales\"\n    ax.ylabel=\"name\"\n    GLMakie.barplot!(ax,1:rows,df.global_sales;color = df.global_sales, strokecolor = :black, strokewidth = 1,direction=:x)\n    for (idx, row) in enumerate(eachrow(df))\n        name,year,sales=row.name,row.year,row.global_sales\n        GLMakie.text!(ax,sales+2,idx; text=\"$year-$sales\",align = (:left, :center),fontsize=8)\n    end\n    GLMakie.hidedecorations!(ax,label = false, ticklabels = false, ticks = false)\n    fig\nend\nplot_top20_game(df9)\n```\n\n::: {.cell-output .cell-output-display execution_count=19}\n![](tidier-method_files/figure-html/cell-19-output-1.png){}\n:::\n:::\n\n\n### 3.10 Sales compearison by genre\n\n::: {#f3ef70c3 .cell execution_count=19}\n``` {.julia .cell-code}\ndf3_10=@chain df begin\n    @select(genre,na_sales,eu_sales,jp_sales,other_sales)\n    @group_by(genre)\n    @summarize(na_sales = sum(na_sales), eu_sales = sum(eu_sales),jp_sales=sum(jp_sales),other_sales=sum(other_sales))\n    @ungroup\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```{=html}\n<div><div style = \"float: left;\"><span>12×5 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">genre</th><th style = \"text-align: left;\">na_sales</th><th style = \"text-align: left;\">eu_sales</th><th style = \"text-align: left;\">jp_sales</th><th style = \"text-align: left;\">other_sales</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String15\" style = \"text-align: left;\">String15</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">Action</td><td style = \"text-align: right;\">877.83</td><td style = \"text-align: right;\">525.0</td><td style = \"text-align: right;\">159.95</td><td style = \"text-align: right;\">187.38</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">Adventure</td><td style = \"text-align: right;\">105.8</td><td style = \"text-align: right;\">64.13</td><td style = \"text-align: right;\">52.07</td><td style = \"text-align: right;\">16.81</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">Fighting</td><td style = \"text-align: right;\">223.59</td><td style = \"text-align: right;\">101.32</td><td style = \"text-align: right;\">87.35</td><td style = \"text-align: right;\">36.68</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">Misc</td><td style = \"text-align: right;\">410.24</td><td style = \"text-align: right;\">215.98</td><td style = \"text-align: right;\">107.76</td><td style = \"text-align: right;\">75.32</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">Platform</td><td style = \"text-align: right;\">447.05</td><td style = \"text-align: right;\">201.63</td><td style = \"text-align: right;\">130.77</td><td style = \"text-align: right;\">51.59</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">Puzzle</td><td style = \"text-align: right;\">123.78</td><td style = \"text-align: right;\">50.78</td><td style = \"text-align: right;\">57.31</td><td style = \"text-align: right;\">12.55</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">Racing</td><td style = \"text-align: right;\">359.42</td><td style = \"text-align: right;\">238.39</td><td style = \"text-align: right;\">56.69</td><td style = \"text-align: right;\">77.27</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">Role-Playing</td><td style = \"text-align: right;\">327.28</td><td style = \"text-align: right;\">188.06</td><td style = \"text-align: right;\">352.31</td><td style = \"text-align: right;\">59.61</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">Shooter</td><td style = \"text-align: right;\">582.6</td><td style = \"text-align: right;\">313.27</td><td style = \"text-align: right;\">38.28</td><td style = \"text-align: right;\">102.69</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">Simulation</td><td style = \"text-align: right;\">183.31</td><td style = \"text-align: right;\">113.38</td><td style = \"text-align: right;\">63.7</td><td style = \"text-align: right;\">31.52</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">Sports</td><td style = \"text-align: right;\">683.35</td><td style = \"text-align: right;\">376.85</td><td style = \"text-align: right;\">135.37</td><td style = \"text-align: right;\">134.97</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">Strategy</td><td style = \"text-align: right;\">68.7</td><td style = \"text-align: right;\">45.34</td><td style = \"text-align: right;\">49.46</td><td style = \"text-align: right;\">11.36</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {#d7f72dde .cell execution_count=20}\n``` {.julia .cell-code}\nfunction plot_df3_10_heatmap(df::AbstractDataFrame)\n    genre=df.genre\n    data=@pipe select(df,Not(:genre))\n    row,col=size(data)\n    ma=@pipe Matrix(data)|>round.(_,digits=1)\n    fig=Figure(resolution=(1000,400))\n    ax=Axis(fig[1,1],title=\"video game sales heatmap\")\n    ax.yticks=(1:col,names(data))\n    ax.xticks=(1:row,genre)\n    heatmap!(ax,ma)\n    [GLMakie.text!(ax,i,j;text=\"$(ma[i,j])\",align = (:center, :center),fontsize=12,color=:white) for i in 1:row,j in 1:col]\n\n    fig\nend\nplot_df3_10_heatmap(df3_10)\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n![](tidier-method_files/figure-html/cell-21-output-1.png){}\n:::\n:::\n\n\n::: {#71c4cd54 .cell execution_count=21}\n``` {.julia .cell-code}\nres10=@pipe df3_10|>select(_,Not(:genre))|>Matrix|>permutedims|>reshape(_,(48,1))|>_[:,1]\ncats=@pipe df3_10|>select(_,Not(:genre))|>names\ntype_name=df3_10.genre\ngrp=repeat(1:4, 12)\ngrp_x=repeat(1:12,inner=4)\ncolors = cgrad(:tab10)\nfunction plot_df3_10_bardodge()\n    fig=Figure(resolution=(1000,600))\n    ax=Axis(fig[1,1],title=\"video game sales  barplot dodge\",xticklabelrotation = pi/8)\n    ax.xticks=(1:12,type_name)\n    GLMakie.barplot!(ax,grp_x,res10; dodge =grp,color=colors[grp],strokecolor = :black, strokewidth = 1,bar_labels = :y,label_rotation=1/2*pi)\n    labels = [\"$i\" for i in cats]\n    elements = [PolyElement(polycolor = colors[i]) for (i,c) in enumerate(cats)]\n   Legend(fig[1,2], elements, labels, \"sales region\", orientation=:vertical, tellwidth = true, tellheight =false)\n    fig\nend\nplot_df3_10_bardodge()\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n![](tidier-method_files/figure-html/cell-22-output-1.png){}\n:::\n:::\n\n\n### 3.11 Sales compearison by platform\n\n::: {#1f90367f .cell execution_count=22}\n``` {.julia .cell-code}\ndf3_11=@chain df begin\n    @select(platform,na_sales,eu_sales,jp_sales,other_sales)\n    @group_by(platform)\n    @summarize(na_sales = sum(na_sales), eu_sales = sum(eu_sales),jp_sales=sum(jp_sales),other_sales=sum(other_sales))\n    @ungroup\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=23}\n```{=html}\n<div><div style = \"float: left;\"><span>31×5 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">6 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">platform</th><th style = \"text-align: left;\">na_sales</th><th style = \"text-align: left;\">eu_sales</th><th style = \"text-align: left;\">jp_sales</th><th style = \"text-align: left;\">other_sales</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String7\" style = \"text-align: left;\">String7</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">2600</td><td style = \"text-align: right;\">90.6</td><td style = \"text-align: right;\">5.47</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.91</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">3DO</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.1</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">3DS</td><td style = \"text-align: right;\">78.87</td><td style = \"text-align: right;\">58.52</td><td style = \"text-align: right;\">97.35</td><td style = \"text-align: right;\">12.63</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">DC</td><td style = \"text-align: right;\">5.43</td><td style = \"text-align: right;\">1.69</td><td style = \"text-align: right;\">8.56</td><td style = \"text-align: right;\">0.27</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">DS</td><td style = \"text-align: right;\">390.71</td><td style = \"text-align: right;\">194.65</td><td style = \"text-align: right;\">175.57</td><td style = \"text-align: right;\">60.53</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">GB</td><td style = \"text-align: right;\">114.32</td><td style = \"text-align: right;\">47.82</td><td style = \"text-align: right;\">85.12</td><td style = \"text-align: right;\">8.2</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">GBA</td><td style = \"text-align: right;\">187.54</td><td style = \"text-align: right;\">75.25</td><td style = \"text-align: right;\">47.33</td><td style = \"text-align: right;\">7.73</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">GC</td><td style = \"text-align: right;\">133.46</td><td style = \"text-align: right;\">38.71</td><td style = \"text-align: right;\">21.58</td><td style = \"text-align: right;\">5.18</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">GEN</td><td style = \"text-align: right;\">19.27</td><td style = \"text-align: right;\">5.52</td><td style = \"text-align: right;\">2.67</td><td style = \"text-align: right;\">0.89</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">GG</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.04</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">N64</td><td style = \"text-align: right;\">139.02</td><td style = \"text-align: right;\">41.06</td><td style = \"text-align: right;\">34.22</td><td style = \"text-align: right;\">4.38</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">NES</td><td style = \"text-align: right;\">125.94</td><td style = \"text-align: right;\">21.15</td><td style = \"text-align: right;\">98.65</td><td style = \"text-align: right;\">5.31</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">NG</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">1.44</td><td style = \"text-align: right;\">0.0</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">20</td><td style = \"text-align: left;\">PSP</td><td style = \"text-align: right;\">108.99</td><td style = \"text-align: right;\">68.25</td><td style = \"text-align: right;\">76.79</td><td style = \"text-align: right;\">42.19</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">21</td><td style = \"text-align: left;\">PSV</td><td style = \"text-align: right;\">16.2</td><td style = \"text-align: right;\">16.33</td><td style = \"text-align: right;\">20.96</td><td style = \"text-align: right;\">8.45</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">22</td><td style = \"text-align: left;\">SAT</td><td style = \"text-align: right;\">0.72</td><td style = \"text-align: right;\">0.54</td><td style = \"text-align: right;\">32.26</td><td style = \"text-align: right;\">0.07</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">23</td><td style = \"text-align: left;\">SCD</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.36</td><td style = \"text-align: right;\">0.45</td><td style = \"text-align: right;\">0.05</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">24</td><td style = \"text-align: left;\">SNES</td><td style = \"text-align: right;\">61.23</td><td style = \"text-align: right;\">19.04</td><td style = \"text-align: right;\">116.55</td><td style = \"text-align: right;\">3.22</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">25</td><td style = \"text-align: left;\">TG16</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.16</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">26</td><td style = \"text-align: left;\">WS</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">1.42</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">27</td><td style = \"text-align: left;\">Wii</td><td style = \"text-align: right;\">507.71</td><td style = \"text-align: right;\">268.38</td><td style = \"text-align: right;\">69.35</td><td style = \"text-align: right;\">80.61</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">28</td><td style = \"text-align: left;\">WiiU</td><td style = \"text-align: right;\">38.32</td><td style = \"text-align: right;\">24.23</td><td style = \"text-align: right;\">12.79</td><td style = \"text-align: right;\">6.45</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">29</td><td style = \"text-align: left;\">X360</td><td style = \"text-align: right;\">601.05</td><td style = \"text-align: right;\">280.58</td><td style = \"text-align: right;\">12.43</td><td style = \"text-align: right;\">85.54</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">30</td><td style = \"text-align: left;\">XB</td><td style = \"text-align: right;\">186.69</td><td style = \"text-align: right;\">60.95</td><td style = \"text-align: right;\">1.38</td><td style = \"text-align: right;\">8.72</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">31</td><td style = \"text-align: left;\">XOne</td><td style = \"text-align: right;\">83.19</td><td style = \"text-align: right;\">45.65</td><td style = \"text-align: right;\">0.34</td><td style = \"text-align: right;\">11.92</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {#b44d5df8 .cell execution_count=23}\n``` {.julia .cell-code}\nlet\n    res11 = @pipe df3_11 |> select(_, Not(:platform)) |> Matrix |> permutedims |> reshape(_, (124, 1)) |> _[:, 1]\n    cats = @pipe df3_11 |> select(_, Not(:platform)) |> names\n    type_name = df3_11.platform\n    grp = repeat(1:4, 31)\n    grp_x = repeat(1:31, inner=4)\n    colors = cgrad(:tab10)\n\n    function plot_platform_dodge()\n        fig = Figure(resolution=(1800, 600))\n        ax = Axis(fig[1, 1], title=\"video game sales by platform\", xticklabelrotation=pi / 8)\n        ax.xticks = (1:31, type_name)\n        GLMakie.barplot!(ax, grp_x, res11; dodge=grp, color=colors[grp], strokecolor=:black, strokewidth=1, bar_labels=:y, label_rotation=1 / 2 * pi)\n        labels = [\"$i\" for i in cats]\n        elements = [PolyElement(polycolor=colors[i]) for (i, c) in enumerate(cats)]\n        Legend(fig[1, 2], elements, labels, \"sales region\", orientation=:vertical, tellwidth=true, tellheight=false)\n        fig\n    end\n\n   plot_platform_dodge()\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=24}\n![](tidier-method_files/figure-html/cell-24-output-1.png){}\n:::\n:::\n\n\n### 3.12 Top 20 Publisher\n\n::: {#fe68e242 .cell execution_count=24}\n``` {.julia .cell-code}\ndf12=@chain df begin\n    @group_by(publisher)\n    @summarize(counts =nrow())\n    @arrange(desc(counts))\n    @slice 1:20\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=25}\n```{=html}\n<div><div style = \"float: left;\"><span>20×2 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">publisher</th><th style = \"text-align: left;\">counts</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"Int64\" style = \"text-align: left;\">Int64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">Electronic Arts</td><td style = \"text-align: right;\">1351</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">Activision</td><td style = \"text-align: right;\">975</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">Namco Bandai Games</td><td style = \"text-align: right;\">932</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">Ubisoft</td><td style = \"text-align: right;\">921</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">Konami Digital Entertainment</td><td style = \"text-align: right;\">832</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">THQ</td><td style = \"text-align: right;\">715</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">703</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">Sony Computer Entertainment</td><td style = \"text-align: right;\">683</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">Sega</td><td style = \"text-align: right;\">639</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">Take-Two Interactive</td><td style = \"text-align: right;\">413</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">Capcom</td><td style = \"text-align: right;\">381</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">Atari</td><td style = \"text-align: right;\">363</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">Tecmo Koei</td><td style = \"text-align: right;\">338</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14</td><td style = \"text-align: left;\">Square Enix</td><td style = \"text-align: right;\">233</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">15</td><td style = \"text-align: left;\">Warner Bros. Interactive Entertainment</td><td style = \"text-align: right;\">232</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16</td><td style = \"text-align: left;\">Disney Interactive Studios</td><td style = \"text-align: right;\">218</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">17</td><td style = \"text-align: left;\">Unknown</td><td style = \"text-align: right;\">203</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">18</td><td style = \"text-align: left;\">Eidos Interactive</td><td style = \"text-align: right;\">198</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">19</td><td style = \"text-align: left;\">Midway Games</td><td style = \"text-align: right;\">198</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">20</td><td style = \"text-align: left;\">505 Games</td><td style = \"text-align: right;\">192</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {#5f815f9a .cell execution_count=25}\n``` {.julia .cell-code}\nfunction plot_top20_publisher(df::AbstractDataFrame)\n    #@assert names(df)[2]==\"counts\"\n    rows=nrow(df)\n    fig=Figure(resolution=(800,800))\n    ax=Axis(fig[1,1],title=\"global sales top 20\")\n    ax.yticks=(1:rows,df[:,\"publisher\"])\n    #ax.xticklabelrotation = pi/2\n    ax.xlabel=\"counts\"\n    ax.ylabel=\"publiser\"\n    GLMakie.barplot!(ax,1:rows,df.counts;color = df.counts, strokecolor = :black, strokewidth = 1,direction=:x)\n    for (idx, row) in enumerate(eachrow(df))\n        publisher,counts=row.publisher,row.counts\n        GLMakie.text!(ax,counts+2,idx; text=\"$counts\",align = (:left, :center),fontsize=8)\n    end\n    GLMakie.hidedecorations!(ax,label = false, ticklabels = false, ticks = false)\n    fig\nend\nplot_top20_publisher(df12)\n```\n\n::: {.cell-output .cell-output-display execution_count=26}\n![](tidier-method_files/figure-html/cell-26-output-1.png){}\n:::\n:::\n\n\n### 3.13  Top global sales by publisher\n\n::: {#e8747ac9 .cell execution_count=26}\n``` {.julia .cell-code}\ndf13=@chain df begin\n    @group_by publisher \n    @summarize sales=sum(global_sales)\n    @arrange desc(sales)\n    @slice 1:20\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=27}\n```{=html}\n<div><div style = \"float: left;\"><span>20×2 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">publisher</th><th style = \"text-align: left;\">sales</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">1786.56</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">Electronic Arts</td><td style = \"text-align: right;\">1110.32</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">Activision</td><td style = \"text-align: right;\">727.46</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">Sony Computer Entertainment</td><td style = \"text-align: right;\">607.5</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">Ubisoft</td><td style = \"text-align: right;\">474.72</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">Take-Two Interactive</td><td style = \"text-align: right;\">399.54</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">THQ</td><td style = \"text-align: right;\">340.77</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">Konami Digital Entertainment</td><td style = \"text-align: right;\">283.64</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">Sega</td><td style = \"text-align: right;\">272.99</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">Namco Bandai Games</td><td style = \"text-align: right;\">254.09</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">Microsoft Game Studios</td><td style = \"text-align: right;\">245.79</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">Capcom</td><td style = \"text-align: right;\">200.89</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">Atari</td><td style = \"text-align: right;\">157.22</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14</td><td style = \"text-align: left;\">Warner Bros. Interactive Entertainment</td><td style = \"text-align: right;\">153.89</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">15</td><td style = \"text-align: left;\">Square Enix</td><td style = \"text-align: right;\">145.18</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16</td><td style = \"text-align: left;\">Disney Interactive Studios</td><td style = \"text-align: right;\">119.96</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">17</td><td style = \"text-align: left;\">Eidos Interactive</td><td style = \"text-align: right;\">98.98</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">18</td><td style = \"text-align: left;\">LucasArts</td><td style = \"text-align: right;\">87.34</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">19</td><td style = \"text-align: left;\">Bethesda Softworks</td><td style = \"text-align: right;\">82.14</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">20</td><td style = \"text-align: left;\">Midway Games</td><td style = \"text-align: right;\">69.85</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {#78a81d9d .cell execution_count=27}\n``` {.julia .cell-code}\nfunction plot_df3_13(df::AbstractDataFrame)\n    #@assert names(df)[2]==\"counts\"\n    rows=nrow(df)\n    fig=Figure(resolution=(800,500))\n    ax=Axis(fig[1,1],title=\"video game sales by publisher\",yreversed=true)\n    ax.yticks=(1:rows,df[:,\"publisher\"])\n    #ax.xticklabelrotation = pi/2\n    ax.xlabel=\"sales\"\n    ax.ylabel=\"pubhisher\"\n    GLMakie.barplot!(ax,1:rows,df.sales;color = df.sales, strokecolor = :black, strokewidth = 1,direction=:x)\n    for (idx, row) in enumerate(eachrow(df))\n        sales=round(row.sales,digits=2)\n        GLMakie.text!(ax,sales+2,idx; text=\"$(sales)\",align = (:left, :center),fontsize=8)\n    end\n    GLMakie.hidedecorations!(ax,label = false, ticklabels = false, ticks = false)\n    fig\nend\nplot_df3_13(df13)\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n![](tidier-method_files/figure-html/cell-28-output-1.png){}\n:::\n:::\n\n\n### 3.14  publisher comparison\n\n::: {#80a3d2f7 .cell execution_count=28}\n``` {.julia .cell-code}\ndf3_14=@chain df begin\n    @group_by(publisher)\n    @summarize( na_sales = sum(na_sales), \n                eu_sales = sum(eu_sales),\n                jp_sales=sum(jp_sales),\n                other_sales=sum(other_sales),\n                global_sales=sum(global_sales)\n    )\n    @arrange desc(global_sales)\n    @slice 1:15\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=29}\n```{=html}\n<div><div style = \"float: left;\"><span>15×6 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">publisher</th><th style = \"text-align: left;\">na_sales</th><th style = \"text-align: left;\">eu_sales</th><th style = \"text-align: left;\">jp_sales</th><th style = \"text-align: left;\">other_sales</th><th style = \"text-align: left;\">global_sales</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">816.87</td><td style = \"text-align: right;\">418.74</td><td style = \"text-align: right;\">455.42</td><td style = \"text-align: right;\">95.33</td><td style = \"text-align: right;\">1786.56</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">Electronic Arts</td><td style = \"text-align: right;\">595.07</td><td style = \"text-align: right;\">371.27</td><td style = \"text-align: right;\">14.04</td><td style = \"text-align: right;\">129.77</td><td style = \"text-align: right;\">1110.32</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">Activision</td><td style = \"text-align: right;\">429.7</td><td style = \"text-align: right;\">215.53</td><td style = \"text-align: right;\">6.54</td><td style = \"text-align: right;\">75.34</td><td style = \"text-align: right;\">727.46</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">Sony Computer Entertainment</td><td style = \"text-align: right;\">265.22</td><td style = \"text-align: right;\">187.72</td><td style = \"text-align: right;\">74.1</td><td style = \"text-align: right;\">80.45</td><td style = \"text-align: right;\">607.5</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">Ubisoft</td><td style = \"text-align: right;\">253.43</td><td style = \"text-align: right;\">163.32</td><td style = \"text-align: right;\">7.5</td><td style = \"text-align: right;\">50.26</td><td style = \"text-align: right;\">474.72</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">Take-Two Interactive</td><td style = \"text-align: right;\">220.49</td><td style = \"text-align: right;\">118.14</td><td style = \"text-align: right;\">5.83</td><td style = \"text-align: right;\">55.24</td><td style = \"text-align: right;\">399.54</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">THQ</td><td style = \"text-align: right;\">208.77</td><td style = \"text-align: right;\">94.73</td><td style = \"text-align: right;\">5.01</td><td style = \"text-align: right;\">32.14</td><td style = \"text-align: right;\">340.77</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">Konami Digital Entertainment</td><td style = \"text-align: right;\">92.16</td><td style = \"text-align: right;\">69.69</td><td style = \"text-align: right;\">91.3</td><td style = \"text-align: right;\">30.31</td><td style = \"text-align: right;\">283.64</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">Sega</td><td style = \"text-align: right;\">109.4</td><td style = \"text-align: right;\">82.0</td><td style = \"text-align: right;\">57.03</td><td style = \"text-align: right;\">24.52</td><td style = \"text-align: right;\">272.99</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">Namco Bandai Games</td><td style = \"text-align: right;\">69.52</td><td style = \"text-align: right;\">42.63</td><td style = \"text-align: right;\">127.07</td><td style = \"text-align: right;\">14.69</td><td style = \"text-align: right;\">254.09</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">Microsoft Game Studios</td><td style = \"text-align: right;\">155.35</td><td style = \"text-align: right;\">68.61</td><td style = \"text-align: right;\">3.26</td><td style = \"text-align: right;\">18.56</td><td style = \"text-align: right;\">245.79</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">Capcom</td><td style = \"text-align: right;\">78.59</td><td style = \"text-align: right;\">39.22</td><td style = \"text-align: right;\">68.08</td><td style = \"text-align: right;\">14.84</td><td style = \"text-align: right;\">200.89</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">Atari</td><td style = \"text-align: right;\">110.04</td><td style = \"text-align: right;\">27.12</td><td style = \"text-align: right;\">10.71</td><td style = \"text-align: right;\">9.01</td><td style = \"text-align: right;\">157.22</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14</td><td style = \"text-align: left;\">Warner Bros. Interactive Entertainment</td><td style = \"text-align: right;\">81.18</td><td style = \"text-align: right;\">53.12</td><td style = \"text-align: right;\">1.04</td><td style = \"text-align: right;\">18.56</td><td style = \"text-align: right;\">153.89</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">15</td><td style = \"text-align: left;\">Square Enix</td><td style = \"text-align: right;\">48.65</td><td style = \"text-align: right;\">32.82</td><td style = \"text-align: right;\">49.88</td><td style = \"text-align: right;\">13.89</td><td style = \"text-align: right;\">145.18</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {#fb434f2a .cell execution_count=29}\n``` {.julia .cell-code}\nres14 = @pipe df3_14 |> select(_, Not(:publisher,:global_sales)) |> Matrix |> permutedims|> reshape(_, (60, 1)) |> _[:, 1]|>round.(_,digits=2)\ncats = @pipe df3_14 |> select(_, Not(:publisher,:global_sales)) |> names\ntype_name = df3_14.publisher\ngrp = repeat(1:4, 15)\ngrp_x = repeat(1:15, inner=4)\ncolors = cgrad(:tab10)\nfunction plot_df3_14_bardodge()\n    fig=Figure(resolution=(1200,600))\n    ax=Axis(fig[1,1],title=\"video game sales  by publisher\",xticklabelrotation = pi/6)\n    ax.xticks=(1:15,type_name)\n    GLMakie.barplot!(ax,grp_x,res14; dodge =grp,color=colors[grp],strokecolor = :black, strokewidth = 1,bar_labels = :y,label_rotation=1/2*pi)\n    labels = [\"$i\" for i in cats]\n    elements = [PolyElement(polycolor = colors[i]) for (i,c) in enumerate(cats)]\n   Legend(fig[1,2], elements, labels, \"sales region\", orientation=:vertical, tellwidth = true, tellheight =false)\n    fig\nend\nplot_df3_14_bardodge()\n```\n\n::: {.cell-output .cell-output-display execution_count=30}\n![](tidier-method_files/figure-html/cell-30-output-1.png){}\n:::\n:::\n\n\n### 3.15 Top publisher by Count each year\n\n::: {#450aa364 .cell execution_count=30}\n``` {.julia .cell-code}\ndf15=@chain df begin\n    @select(year,publisher)\n    @group_by(year,publisher)\n    @summarize(nrow =nrow())\n    @arrange(desc(nrow)) # 在每个组中按全球销售额降序排列\n    @slice(1)              # 每组销量最多的\n    @ungroup\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=31}\n```{=html}\n<div><div style = \"float: left;\"><span>40×3 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">15 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">year</th><th style = \"text-align: left;\">publisher</th><th style = \"text-align: left;\">nrow</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String7\" style = \"text-align: left;\">String7</th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"Int64\" style = \"text-align: left;\">Int64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">1980</td><td style = \"text-align: left;\">Activision</td><td style = \"text-align: right;\">5</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">1981</td><td style = \"text-align: left;\">Atari</td><td style = \"text-align: right;\">11</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">1982</td><td style = \"text-align: left;\">Atari</td><td style = \"text-align: right;\">14</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">1983</td><td style = \"text-align: left;\">Atari</td><td style = \"text-align: right;\">6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">1984</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">9</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">1985</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">7</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">1986</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">1987</td><td style = \"text-align: left;\">Atari</td><td style = \"text-align: right;\">4</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">1988</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">1989</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">9</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">1990</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">7</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">1991</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">13</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">1992</td><td style = \"text-align: left;\">Nintendo</td><td style = \"text-align: right;\">10</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">29</td><td style = \"text-align: left;\">2008</td><td style = \"text-align: left;\">Electronic Arts</td><td style = \"text-align: right;\">120</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">30</td><td style = \"text-align: left;\">2009</td><td style = \"text-align: left;\">Activision</td><td style = \"text-align: right;\">121</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">31</td><td style = \"text-align: left;\">2010</td><td style = \"text-align: left;\">Activision</td><td style = \"text-align: right;\">89</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">32</td><td style = \"text-align: left;\">2011</td><td style = \"text-align: left;\">Ubisoft</td><td style = \"text-align: right;\">87</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">33</td><td style = \"text-align: left;\">2012</td><td style = \"text-align: left;\">Namco Bandai Games</td><td style = \"text-align: right;\">85</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">34</td><td style = \"text-align: left;\">2013</td><td style = \"text-align: left;\">Namco Bandai Games</td><td style = \"text-align: right;\">63</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">35</td><td style = \"text-align: left;\">2014</td><td style = \"text-align: left;\">Namco Bandai Games</td><td style = \"text-align: right;\">69</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">36</td><td style = \"text-align: left;\">2015</td><td style = \"text-align: left;\">Namco Bandai Games</td><td style = \"text-align: right;\">68</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">37</td><td style = \"text-align: left;\">2016</td><td style = \"text-align: left;\">Namco Bandai Games</td><td style = \"text-align: right;\">40</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">38</td><td style = \"text-align: left;\">2017</td><td style = \"text-align: left;\">Sega</td><td style = \"text-align: right;\">2</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">39</td><td style = \"text-align: left;\">2020</td><td style = \"text-align: left;\">Ubisoft</td><td style = \"text-align: right;\">1</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">40</td><td style = \"text-align: left;\">N/A</td><td style = \"text-align: left;\">Unknown</td><td style = \"text-align: right;\">103</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {#a29fcaff .cell execution_count=31}\n``` {.julia .cell-code}\nfunction plot_df3_15(df::AbstractDataFrame)\n    #@assert names(df)[2]==\"counts\"\n    rows=nrow(df)\n    fig=Figure(resolution=(800,800))\n    ax=Axis(fig[1,1],title=\"publiher champion by year\")\n    ax.yticks=(1:rows,df[:,\"year\"])\n    #ax.xticklabelrotation = pi/2\n    ax.xlabel=\"counts\"\n    ax.ylabel=\"name\"\n    GLMakie.barplot!(ax,1:rows,df.nrow;color = df.nrow, strokecolor = :black, strokewidth = 1,direction=:x)\n    for (idx, row) in enumerate(eachrow(df))\n        publisher,nrow,year=row.publisher,row.nrow,row.year\n        GLMakie.text!(ax,nrow+2,idx; text=\"$publisher-$nrow\",align = (:left, :center),fontsize=8)\n    end\n    GLMakie.hidedecorations!(ax,label = false, ticklabels = false, ticks = false)\n    fig\nend\nplot_df3_15(df15)\n```\n\n::: {.cell-output .cell-output-display execution_count=32}\n![](tidier-method_files/figure-html/cell-32-output-1.png){}\n:::\n:::\n\n\n### 3.16 Total revenue by region\n\n::: {#6b4023be .cell execution_count=32}\n``` {.julia .cell-code}\ndf3_16=@chain df begin\n    @select(na_sales,eu_sales,jp_sales,other_sales,global_sales)\n    \n    @summarize( na_sales = sum(na_sales), \n                eu_sales = sum(eu_sales),\n                jp_sales=sum(jp_sales),\n                other_sales=sum(other_sales),\n                global_sales=sum(global_sales)\n    )\nend\n#df3_16.region=[\"na_sales\", \"eu_sales\", \"jp_sales\", \"other_sales\",\"global_sales\"]\n```\n\n::: {.cell-output .cell-output-display execution_count=33}\n```{=html}\n<div><div style = \"float: left;\"><span>1×5 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">na_sales</th><th style = \"text-align: left;\">eu_sales</th><th style = \"text-align: left;\">jp_sales</th><th style = \"text-align: left;\">other_sales</th><th style = \"text-align: left;\">global_sales</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: right;\">4392.95</td><td style = \"text-align: right;\">2434.13</td><td style = \"text-align: right;\">1291.02</td><td style = \"text-align: right;\">797.75</td><td style = \"text-align: right;\">8920.44</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n###  3.17 Sales Histogram\n\n::: {#7a40e7fc .cell execution_count=33}\n``` {.julia .cell-code}\n# 在@chain 中做转换是可以的, 但是要处理-Inf 的问题 log(0)==-Inf,所以放到绘图时处理\ndf17=@chain df begin\n    @select(na_sales,eu_sales,jp_sales,other_sales,global_sales)\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=34}\n```{=html}\n<div><div style = \"float: left;\"><span>16598×5 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">16573 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">na_sales</th><th style = \"text-align: left;\">eu_sales</th><th style = \"text-align: left;\">jp_sales</th><th style = \"text-align: left;\">other_sales</th><th style = \"text-align: left;\">global_sales</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: right;\">41.49</td><td style = \"text-align: right;\">29.02</td><td style = \"text-align: right;\">3.77</td><td style = \"text-align: right;\">8.46</td><td style = \"text-align: right;\">82.74</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: right;\">29.08</td><td style = \"text-align: right;\">3.58</td><td style = \"text-align: right;\">6.81</td><td style = \"text-align: right;\">0.77</td><td style = \"text-align: right;\">40.24</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: right;\">15.85</td><td style = \"text-align: right;\">12.88</td><td style = \"text-align: right;\">3.79</td><td style = \"text-align: right;\">3.31</td><td style = \"text-align: right;\">35.82</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: right;\">15.75</td><td style = \"text-align: right;\">11.01</td><td style = \"text-align: right;\">3.28</td><td style = \"text-align: right;\">2.96</td><td style = \"text-align: right;\">33.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: right;\">11.27</td><td style = \"text-align: right;\">8.89</td><td style = \"text-align: right;\">10.22</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">31.37</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: right;\">23.2</td><td style = \"text-align: right;\">2.26</td><td style = \"text-align: right;\">4.22</td><td style = \"text-align: right;\">0.58</td><td style = \"text-align: right;\">30.26</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: right;\">11.38</td><td style = \"text-align: right;\">9.23</td><td style = \"text-align: right;\">6.5</td><td style = \"text-align: right;\">2.9</td><td style = \"text-align: right;\">30.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: right;\">14.03</td><td style = \"text-align: right;\">9.2</td><td style = \"text-align: right;\">2.93</td><td style = \"text-align: right;\">2.85</td><td style = \"text-align: right;\">29.02</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: right;\">14.59</td><td style = \"text-align: right;\">7.06</td><td style = \"text-align: right;\">4.7</td><td style = \"text-align: right;\">2.26</td><td style = \"text-align: right;\">28.62</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: right;\">26.93</td><td style = \"text-align: right;\">0.63</td><td style = \"text-align: right;\">0.28</td><td style = \"text-align: right;\">0.47</td><td style = \"text-align: right;\">28.31</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: right;\">9.07</td><td style = \"text-align: right;\">11.0</td><td style = \"text-align: right;\">1.93</td><td style = \"text-align: right;\">2.75</td><td style = \"text-align: right;\">24.76</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: right;\">9.81</td><td style = \"text-align: right;\">7.57</td><td style = \"text-align: right;\">4.13</td><td style = \"text-align: right;\">1.92</td><td style = \"text-align: right;\">23.42</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: right;\">9.0</td><td style = \"text-align: right;\">6.18</td><td style = \"text-align: right;\">7.2</td><td style = \"text-align: right;\">0.71</td><td style = \"text-align: right;\">23.1</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16587</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16588</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16589</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16590</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16591</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16592</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16593</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16594</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16595</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16596</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16597</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">16598</td><td style = \"text-align: right;\">0.01</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.01</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "tidier-method_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}