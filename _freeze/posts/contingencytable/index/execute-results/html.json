{
  "hash": "129291f7971244716a32ee0af0eb46b0",
  "result": {
    "markdown": "---\ntitle: \"using DataFrame construct cotingencytable\"\nauthor: \"math4mads\"\ndate: \"2023-09-14\"\ncategories: [dataframe, code,julia]\nimage: \"image.jpg\"\n---\n\n:::{.callout-note}\n   **cotingencytable**是理解和研究条件概率的工具 \n   \n   - [**ref:**](https://statisticsbyjim.com/basics/contingency-table/)\n   \n   - 列联表(双向表,cotingencytable,two-way table),是研究两个变量\n     不同水平(变量取值)之间相互关系的图表展示方法\n   - 表中最大行和最大列是边缘分布\n   - 表中单元格取值是两个变量的联合分布\n:::\n\n手动输入可以使用:\n\n::: {.callout-tip title=\"build two-way table in this page \"}\n   [`RapidTable`](https://www.rapidtables.com/tools/table-chart.html#)\n:::\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\ninclude(\"../utils.jl\")\nusing  DataFrames\nusing  Random\nRandom.seed!(34343)\n```\n\n::: {.cell-output .cell-output-display execution_count=76}\n```\nTaskLocalRNG()\n```\n:::\n:::\n\n\n## 1. load data\n\n::: {.cell execution_count=2}\n``` {.julia .cell-code}\n desc=Stat2Table(0,\"flavor_preference\",\"icecream flavor\",[])\n data=@pipe load_csv(desc.name)\n show(first(data,10))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n6×4 DataFrame\n Row │ Gender   Flavor      Frequency  Row%    \n     │ String7  String15    Int64      Float64 \n─────┼─────────────────────────────────────────\n   1 │ Female   Chocolate          37     56.0\n   2 │ Female   Strawberry         17     25.8\n   3 │ Female   Vanilla            12     18.2\n   4 │ Male     Chocolate          21     29.6\n   5 │ Male     Strawberry         18     25.4\n   6 │ Male     Vanilla            32     45.0\n```\n:::\n:::\n\n\n## 2. two-way-table\n`:Gender 做为列, :Flavour 作为行,  :Frequency 是值`\n\n::: {.cell execution_count=3}\n``` {.julia .cell-code}\ntwoway_table=unstack(data,:Gender,:Flavor,:Frequency)\n```\n\n::: {.cell-output .cell-output-display execution_count=78}\n```{=html}\n<div><div style = \"float: left;\"><span>2×4 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">Gender</th><th style = \"text-align: left;\">Chocolate</th><th style = \"text-align: left;\">Strawberry</th><th style = \"text-align: left;\">Vanilla</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String7\" style = \"text-align: left;\">String7</th><th title = \"Union{Missing, Int64}\" style = \"text-align: left;\">Int64?</th><th title = \"Union{Missing, Int64}\" style = \"text-align: left;\">Int64?</th><th title = \"Union{Missing, Int64}\" style = \"text-align: left;\">Int64?</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">Female</td><td style = \"text-align: right;\">37</td><td style = \"text-align: right;\">17</td><td style = \"text-align: right;\">12</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">Male</td><td style = \"text-align: right;\">21</td><td style = \"text-align: right;\">18</td><td style = \"text-align: right;\">32</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 3. add :Total  Col\n\n::: {.cell execution_count=4}\n``` {.julia .cell-code}\ntwt=combine(twoway_table,:,[:Chocolate,:Strawberry,:Vanilla]=>((a,b,c)->sum([a,b,c]))=>:Total)\n```\n\n::: {.cell-output .cell-output-display execution_count=79}\n```{=html}\n<div><div style = \"float: left;\"><span>2×5 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">Gender</th><th style = \"text-align: left;\">Chocolate</th><th style = \"text-align: left;\">Strawberry</th><th style = \"text-align: left;\">Vanilla</th><th style = \"text-align: left;\">Total</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String7\" style = \"text-align: left;\">String7</th><th title = \"Union{Missing, Int64}\" style = \"text-align: left;\">Int64?</th><th title = \"Union{Missing, Int64}\" style = \"text-align: left;\">Int64?</th><th title = \"Union{Missing, Int64}\" style = \"text-align: left;\">Int64?</th><th title = \"Int64\" style = \"text-align: left;\">Int64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">Female</td><td style = \"text-align: right;\">37</td><td style = \"text-align: right;\">17</td><td style = \"text-align: right;\">12</td><td style = \"text-align: right;\">66</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">Male</td><td style = \"text-align: right;\">21</td><td style = \"text-align: right;\">18</td><td style = \"text-align: right;\">32</td><td style = \"text-align: right;\">71</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## 4. add :Total Row  \n\n::: {.cell execution_count=5}\n``` {.julia .cell-code}\ninsert!(twt, 3 ,[\"Total\",sum.(eachcol(twt)[2:end])...])\n```\n\n::: {.cell-output .cell-output-display execution_count=80}\n```{=html}\n<div><div style = \"float: left;\"><span>3×5 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">Gender</th><th style = \"text-align: left;\">Chocolate</th><th style = \"text-align: left;\">Strawberry</th><th style = \"text-align: left;\">Vanilla</th><th style = \"text-align: left;\">Total</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String7\" style = \"text-align: left;\">String7</th><th title = \"Union{Missing, Int64}\" style = \"text-align: left;\">Int64?</th><th title = \"Union{Missing, Int64}\" style = \"text-align: left;\">Int64?</th><th title = \"Union{Missing, Int64}\" style = \"text-align: left;\">Int64?</th><th title = \"Int64\" style = \"text-align: left;\">Int64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">Female</td><td style = \"text-align: right;\">37</td><td style = \"text-align: right;\">17</td><td style = \"text-align: right;\">12</td><td style = \"text-align: right;\">66</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">Male</td><td style = \"text-align: right;\">21</td><td style = \"text-align: right;\">18</td><td style = \"text-align: right;\">32</td><td style = \"text-align: right;\">71</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">Total</td><td style = \"text-align: right;\">58</td><td style = \"text-align: right;\">35</td><td style = \"text-align: right;\">44</td><td style = \"text-align: right;\">137</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n### 5. read table\n建立表格后,就可以用来计算条件概率,按照`dataframe`的行列读取方式\n\n### 5.1   边缘概率\n统计参加试验的女性总人数\n\n::: {.cell execution_count=6}\n``` {.julia .cell-code}\n \"参加实验的女性总人数\"=>twt[1,:Total]\n```\n\n::: {.cell-output .cell-output-display execution_count=81}\n```\n\"参加实验的女性总人数\" => 66\n```\n:::\n:::\n\n\n计算试验中喜欢巧克力口味冰激凌的总人数\n\n::: {.cell execution_count=7}\n``` {.julia .cell-code}\n \"喜欢巧克力冰激凌总人数\"=>twt[3,:Chocolate]\n```\n\n::: {.cell-output .cell-output-display execution_count=82}\n```\n\"喜欢巧克力冰激凌总人数\" => 58\n```\n:::\n:::\n\n\n参加试验的总数\n\n::: {.cell execution_count=8}\n``` {.julia .cell-code}\n\"参加试验的总数\"=>twt[3,:Total]\n```\n\n::: {.cell-output .cell-output-display execution_count=83}\n```\n\"参加试验的总数\" => 137\n```\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}